<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/carbon-route/carbon-location.html">
<link rel="import" href="../../bower_components/carbon-route/carbon-route.html">
<link rel="import" href="../../bower_components/app-layout/app-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/effects/waterfall.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../contact-card/contact-card.html">

<dom-module id="auth-app">
  <template>
    <style>
      :host {
        display: block;
      }
      .login-actions {
        @apply(--layout-horizontal);
        @apply(--layout-end-justified);
        padding: 0.5em 14px;
      }
      .login-actions paper-button {
        @apply(--layout-self-end);
        border: 1px solid var(--paper-button-ink-color);
      }

      app-toolbar h1 {
        font-size: var(--app-toolbar-font-size, 20px);
        font-weight: normal;
      }
    </style>

    <carbon-location route="{{route}}" use-hash-as-path></carbon-location>
    <carbon-route
        route="{{route}}"
        pattern="/:page"
        data="{{data}}"
        tail="{{subRoute}}"></carbon-route>

    <app-scrollpos-control
      selected="[[data.page]]"></app-scrollpos-control>
    <app-drawer-layout responsive-width="1280px" drawer-width="250px">
      <app-drawer id="drawer" swipe-open>
        <app-header-layout has-scrolling-region>
          <div class="login-actions">
            <template is="dom-if" if="{{!user}}">
              <paper-button noink>Login</paper-button>
            </template>
            <template is="dom-if" if="{{user}}">
              <paper-button noink>Logout</paper-button>
            </template>
          </div>
          <template is="dom-if" if="{{user}}">
            <contact-card user="{{user}}">
            </contact-card>
          </template>
          <!-- nav menu -->
          <paper-listbox selected="{{data.page}}"
            attr-for-selected="name"
            on-iron-activate="drawerSelected">
            <paper-item name="home">Home</paper-item>
            <paper-item name="public-route">Public Route</paper-item>
            <paper-item name="private-route">Private Route</paper-item>
          </paper-listbox>
        </app-header-layout>
      </app-drawer>
      <!-- main panel -->
      <app-header-layout>
        <app-header fixed effects="waterfall">
          <app-toolbar class="title-toolbar main-title-toolbar">
            <paper-icon-button drawer-toggle icon="menu" alt="Toggle menu" noink></paper-icon-button>
            <h1 class="title">App Title</h1>
          </app-toolbar>
        </app-header>
        <!-- list/detail pages -->
        <iron-pages selected="[[data.page]]" attr-for-selected="name">
          <!-- list page -->
          <iron-pages name="home" attr-for-selected="name">
            Home
          </iron-pages>
          <iron-pages name="public-route" attr-for-selected="name">
            Public Route
          </iron-pages>
          <iron-pages name="private-route" attr-for-selected="name">
            Private route
          </iron-pages>
        </iron-pages>
      </app-header-layout>
    </app-drawer-layout>
  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'auth-app',

        properties: {
          route: Object,
          data: Object,
          subRoute: Object,
          pageData: Object,
          idData: Object,
          user: {
            type: Object,
            notify: true
          }
        },

        attached: function() {
          this.async(function() {
            this.route.path = 'home';
            this.user = {
              "name": "Peter Grzegorz Blazejewicz",
              "email": "email@example.com"
            }
          });
        },
        drawerSelected: function() {
          if (!this.$.drawer.persistent) this.$.drawer.close();
        },
        ready: function() {
          this.async(function() {
            if(!this.route.path) {
              this.set('route.path', '/home');
            }
          });
        }
      });
    })();
  </script>
</dom-module>
